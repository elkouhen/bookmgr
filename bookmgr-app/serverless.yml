service: bookmgr-app

frameworkVersion: '2'

provider:
  name: aws
  runtime: python3.8

plugins:
  - fullstack-serverless

custom:

  fullstack:
    domain: www.melkouhen.me
    certificate: arn:aws:acm:us-east-1:629923658207:certificate/c2519af3-3275-466d-96f9-0986b2398a83
    bucketName: bookmgr-app-2020
    distributionFolder: build
    indexDocument: index.html
    errorDocument: error.html
    singlePageApp: true
    compressWebContent: true
    apiPath: ${opt:stage, self:provider.stage}
    apiGatewayRestApiId: ${cf:bookmgr-api-dev.AwsDocApiId}
    # apiGatewayRestApiId: 8237gkp5j6
    clientCommand: yarn build
    clientSrcPath: .
    minimumProtocolVersion: TLSv1.2_2018
    priceClass: PriceClass_100
    noConfirm: true

#  stage: ${opt:stage, self:provider.stage}

resources: # CloudFormation template syntax
  Resources:
    WebsiteDNSRecord:
      Type: 'AWS::Route53::RecordSetGroup'
      Properties:
        HostedZoneId: 'Z0524616Y7E6M344S9XD'
        RecordSets:
          - Name: 'www.melkouhen.me'
            Type: A
            AliasTarget:
                HostedZoneId: 'Z2FDTNDATAQYW2'
                DNSName: 'd2e9gk7ggx79bj.cloudfront.net'